# Ignition MITM

## How to run
- `python final-exploit.py`
- See main README for more options

## How it works
The attack is composed of a 3 stage pipeline: CAM Overflow, ARP Poisoning, and Modbus Hijacking. The CAM Overflow attack is mean to cause the switch to act as a hub. Since all memory wihtin the swtich is full of bogus MAC addresses, the switch will send the traffic out of all ports as an unknown broadcast. This allows the attacker to see traffic in the switch that was not destined for them. The ARP poisoning attack then causes all traffic from the specified devices to be routed through the attacker machine. The attacker upon reception will just forward the packets to the destination, with the exception of Modbus traffic. The Modbus Hijacking attack will selectively drop, craft, and send new packets to fool the devices into thinking everying is okay. For example, if the Client sends a WriteCoil request then the attacker will intercept that packet, drop it, and craft a new one that does the opposite of the WriteCoil. So if the WriteCoil request asks to turn something on, then it will craft a new packet that says turn it off. Upon reception of the Response from the Server device, it will intercept, drop, and craft a packet that makes it appear that the WriteCoil request was successful. 