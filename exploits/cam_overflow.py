#!/usr/bin/env python3
"""
file:       cam_overflow.py
author:     Chris Tremblay <cst1465@rit.edu>
language:   Python3
date:       2/13/2023, National Clean Your Computer Day
description:
    perform a cam overflow attack
"""

import scapy.all as scapy
from random import getrandbits
from binascii import b2a_hex

def gen_random_mac() -> str:
    """
    description:
        generate a random mac address
    returns:
        the mac address in string form
    """
    # generate 48 random bits
    rand_bits = '%x' % getrandbits( 48 )

    # place semicolon to deliniate each pair of bytes
    mac = ""
    for i in range( 1, len( rand_bits ), 2 ):
        mac += rand_bits[i-1] + rand_bits[i] + ":"

    # strip off last element and return
    mac = mac[:-1]
    return mac

def send_arp( dst_addr: str, src_addr: str, src_mac: str ):
    """
    description:
        send a malicious arp to make switch CAM table
        start learning bad MAC addrs
    parameters:
        dst_addr -> the destination addr in arp broadcast
        src_addr -> the source addres of arp broadcast
        src_mac  -> the source mac address 
    """
    # create packet
    arp = scapy.ARP( op = 2 )
    return

def main():
    """
    description:
        driver function
    """
    gen_random_mac()
    return

if( __name__ == "__main__" ):
    main()
